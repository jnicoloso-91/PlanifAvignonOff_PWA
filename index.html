
<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">

  <title>Planificateur Avignon Off</title>

  <link rel="manifest" href="./manifest.webmanifest" />
  <meta name="theme-color" content="#0d1117">

  <!-- PWA / iOS -->
  <link rel="apple-touch-icon" href="./apple-touch-icon-180.png" sizes="180x180">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">

  <!-- Favicon classique -->
  <link rel="icon" href="./favicon.ico" sizes="16x16 32x32 48x48">

  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">  <meta name="theme-color" content="#0d1117" />

  <!-- Styles -->
  <link rel="stylesheet" href="./ag-grid.css" />
  <link rel="stylesheet" href="./styles.css" />

  <!-- AG Grid (local, déjà dans ta racine) -->
  <script src="./ag-grid-community.min.js"></script>

  <!-- SheetJS (Excel) — place lib/xlsx.full.min.js localement -->
  <script src="./lib/xlsx.full.min.js"></script>
</head>

<body>
  <header class="app-header"> 
    <img src="./icon-192.png" alt="Planif Avignon" class="app-logo">
  </header>

  <!-- EXPANDER 1 : Activités programmées -->
  <div class="st-expander" id="exp-programmees">
    <div class="st-expander-header">
      <span class="chevron"></span>
      <span class="title" id="titleA">Programme</span>
    </div>
    <div class="st-expander-body">
      <!-- <div id="gridA" class="ag-theme-quartz compact" style="width:100%;height:35vh;"></div> -->
      <div id="gridA" class="ag-theme-quartz compact grid-host"></div>
    </div>
  </div>

  <!-- Séparateur -->
  <div class="v-splitter" data-top="exp-programmees" data-bottom="exp-non-programmees">
    <div class="v-splitter__handle" title="Redimensionner"></div>
  </div>

  <!-- EXPANDER 3 : Créneaux disponibles -->
  <div class="st-expander" id="exp-creneaux">
    <div class="st-expander-header">
      <span class="chevron"></span>
      <span class="title" id="titleC">Plages libres</span>
    </div>
    <div class="st-expander-body">
      <!-- <div id="gridC" class="ag-theme-quartz compact" style="width:100%;height:28vh;"></div> -->
      <div id="gridC" class="ag-theme-quartz compact grid-host"></div>
    </div>
  </div>

  <!-- Séparateur -->
  <div class="v-splitter" data-top="exp-creneaux" data-bottom="exp-programmables">
    <div class="v-splitter__handle" title="Redimensionner"></div>
  </div>

  <!-- EXPANDER 4 : Activités programmables -->
  <div class="st-expander" id="exp-programmables">
    <div class="st-expander-header">
      <span class="chevron"></span>
      <span class="title" id="titleD">Programmer...</span>
    </div>
    <div class="st-expander-body">
      <!-- <div id="gridD" class="ag-theme-quartz compact" style="width:100%;height:28vh;"></div> -->
      <div id="gridD" class="ag-theme-quartz compact grid-host"></div>
    </div>
  </div>

  <!-- Séparateur -->
  <div class="v-splitter" data-top="exp-programmables" data-bottom="exp-contacts">
    <div class="v-splitter__handle" title="Redimensionner"></div>
  </div>

  <!-- EXPANDER 2 : Activités non programmées -->
  <div class="st-expander" id="exp-non-programmees">
    <div class="st-expander-header">
      <span class="chevron"></span>
      <span class="title" id="titleB">Stock d'activités</span>
    </div>
    <div class="st-expander-body">
      <!-- <div id="gridB" class="ag-theme-quartz compact" style="width:100%;height:35vh;"></div> -->
      <div id="gridB" class="ag-theme-quartz compact grid-host"></div>
    </div>
  </div>

  <!-- Séparateur -->
  <div class="v-splitter" data-top="exp-non-programmees" data-bottom="exp-creneaux">
    <div class="v-splitter__handle" title="Redimensionner"></div>
  </div>

  <!-- EXPANDER 5 : Carnet d’adresses -->
  <div class="st-expander" id="exp-contacts">
    <div class="st-expander-header">
      <span class="chevron"></span>
      <span class="title" id="titleE">Carnet d’adresses</span>
    </div>
    <div class="st-expander-body">
      <!-- <div id="gridE" class="ag-theme-quartz compact" style="width:100%;height:30vh;"></div> -->
      <div id="gridE" class="ag-theme-quartz compact grid-host"></div>
    </div>
  </div>

  <!-- Séparateur -->
  <div class="v-splitter" data-top="exp-contacts" data-bottom="exp-creneaux">
    <div class="v-splitter__handle" title="Redimensionner"></div>
  </div>

  <div class="page-end-spacer"></div>

  <!-- Bottom Bar -->
  <div class="bottom-bar" id="bottomBar" role="toolbar" aria-label="Actions">
    <div class="bottom-bar__scroller" id="bottomBarScroller">

      <!-- Bouton Fichier -->
      <button class="bb-icon-btn" id="btn-file">
        <svg class="bb-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M4 4h7l3 3h6v13H4z"/>
        </svg>
        <span class="bb-label">Fichier</span>
      </button>

      <!-- Bouton Défaire -->
      <button class="bb-icon-btn" id="btn-undo">
        <svg class="bb-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M3 7v6h6M3 13a9 9 0 1 0 9-9"/>
        </svg>
        <span class="bb-label">Défaire</span>
      </button>

      <!-- Bouton Refaire -->
      <button class="bb-icon-btn" id="btn-redo">
        <svg class="bb-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M21 7v6h-6M21 13a9 9 0 1 1-9-9"/>
        </svg>
        <span class="bb-label">Refaire</span>
      </button>

      <!-- Bouton Ajouter avec collage -->
      <button class="bb-icon-btn" id="btn-paste">
        <svg class="bb-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M4 4h7l3 3h6v13H4z"/>
          <path d="M9 14h6"/>
          <path d="M9 18h6"/>
        </svg>
        <span class="bb-label">Coller</span>
      </button>

      <!-- Bouton Ajouter -->
      <button class="bb-icon-btn" id="btn-add">
        <svg class="bb-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="12" y1="5" x2="12" y2="19"/>
          <line x1="5" y1="12" x2="19" y2="12"/>
        </svg>
        <span class="bb-label">Ajouter</span>
      </button>

    </div>
  </div>

  <!-- Languette dela Bottom Bar -->
  <button id="toggleBar" class="bar-toggle" aria-label="Montrer ou cacher la barre">^</button>
  
  <!-- Masque de la Bottom Bar sur la safe-area d'IOS -->
  <div id="safeMask" class="safe-bottom-mask"></div>

  <!-- input fichier caché pour import -->
  <input type="file" id="fileInput" accept=".xlsx,.xls" style="display:none" />

  <script src="https://cdn.jsdelivr.net/pyodide/v0.26.1/full/pyodide.js"></script>
  <script type="module" src="./app.js"></script>

  <script>
    // PWA : enregistre le service worker (offline basique)
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('./service-worker.js').catch(() => {});
    }
  </script>
</body>
</html>